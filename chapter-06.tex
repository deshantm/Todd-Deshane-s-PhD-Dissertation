pter-06.tex

\chapter{Conclusion}

In this dissertation, we presented the design and implementation of a Rapid Recovery Desktop system based on open source technologies. For this system, we created a file server virtual machine (FS-VM), a network virtual machine (NET-VM), a virtual machine contract system, and a virtualization security framework (OSCKAR). We evaluated our system in terms of performance and effectiveness. We hope that the approach presented in this dissertation will have a lasting impact on the users, developers, and security professionals that interact with computer systems.


\section{Future Work}

Throughout this dissertation we briefly mentioned various future work possibilities. In this section, we expand on those and discuss several general areas of future work. In particular, there is an interesting area of research at the intersection of Human Computer Interaction (HCI) and Security (SEC) in a field called HCI-SEC. Other future work opportunities include using a system similar to ours to collect and analyze malware. We also consider various implementation-related future work opportunities. Finally, we describe briefly the potential to port our system to other environments (for example, servers and mobile platforms).

\subsection{HCI-SEC}

Not only is it important to build a secure system, but the system also needs to be usable. The problem of usable security often comes back to the conclusion that it would be best to try to take the user out of the security equation\cite{cranor_2008}. However, we suggest that this argument is flawed and in future work we hope to consider methods that accurately involve the user in a way that takes the user's intent into account properly. By isolating applications in virtual appliances and requiring that sharing between application to be explicit, we hope to show that user intent can play an important role in the security equation. General recommendations for usable security were presented in detail by Garfinkel\cite{simson_2006}.

\subsection{Malware Collection and Analysis}

In the evaluation of Chapter 5, we showed that our system can respond appropriately to many types of malware attacks. One common challenge that we faced was the fact that allowing the normal activity of the virtual appliances leaves the system vulnerable to malware that acts similar to a normal user (for example, malware that uses the same communication channels at the expected rates of use). However, if our system is used exclusively to collect and analyze malware (and not be in use by an actual user), then any activity on the system should be considered suspicious. Systems set up for the sole purpose of malware collection and analysis are often referred to as honeypots. Using our system as a honeypot would be an interesting area of future work, since it is already instrumented to support a variety of guest operating systems and selectively control network and disk accesses using central policy management and various enforcement elements. Using virtualization to support honeypots has been a common practice\cite{vrable_2005}, but taking virtual appliance interaction into account by carefully monitoring the actions of the malware could provide new insights into the activity of stealthy malware. We could then use any new information obtained to improve our system design and implementation.

Another related method for malware collection and analysis would be a more active client-based honeypot approach. This approach is more similar to a web crawler, but for malware. The basic idea is to use a browser (or simulation of a browser) to visit various websites and detect if the website contains malware.  Using our system to do this simulation and detection could allow for a high degree of interaction and detection. For example, network and disk rules could be used to detect problems. A recent approach to detection and analysis of drive\-by\-download attacks and malicious JavaScript code presented by Cova et. al.\cite{cova_2010}. The techniques used in their work along with the help of our system may be able to be used to crawl the web for malware, but further investigation is needed.

\subsection{Implementation-related Improvements}

In chapters 3 and 4 on design and implementation, we focused on the advantages of our system. However, we did not detail the limitations of our system. In this section we describe some limitations and areas of our implementation that could be improved. Some of the limitations are based on the lack of current hardware or software availability or support. Other limitations are due to the fact that we choose not to implement specific features and adding them is an engineering exercise. We break down the implementation future work into the categories of FS-VM improvements, NET-VM improvements, OSCKAR improvements, enforcement element additions, and overall system improvements.

\subsubsection{FS-VM Improvements}

There are several ways that our FS-VM component could be improved. One such enhancement could be to add a more advanced file system with built-in roll back capabilities. This would allow easier roll-back at the file system level. There are a couple of different file system level approaches that could prove effective, including a copy on write file system, such as Btrfs\cite{btrfs_website}, or a log-structured file system, such as NILFS\cite{nilfs_website}. These types of approaches may prove more effective than LVM snapshots or qcow2 disk images, but further exploration is still needed.

Other possible FS-VM improvements include fined-grained tracking of file system accesses. Although using virtual machine contracts for virtual appliances in our system provides access control at the virtual appliance level, it would be even better to be able to track and manage reads and writes at a per-virtual-appliance granularity. Having a finer granularity of control could aid in more fined-grained roll back and recovery. For instance, with our current system, if a compromise is detected, it may be necessary to roll back to a known good snapshot of some particular shared data, but if access was tracked more precisely, selective restoration of only the compromised data could be done instead. This type of fine-grained file system tracking could also play an important role in forensic analysis (or studying digital artifacts left by malware).

Lastly, simply integrating better components and technologies could improve the FS-VM component. For example, using Samba as the network file system is a convenient choice as it allows us to implement basic functionality, such as read and write limiting, without needing to modify the guest kernel. However, using more advanced network-attached storage software, such as OpenFiler\cite{openfiler_website}, FreeNAS\cite{freenas_website}, or OpenMediaVault\cite{openmediavault_website} could provide better functionality and file system enforcement options. Other technologies that could be integrated to provide more functionality or security are MAC systems, such as SELinux or AppArmor.

\subsubsection{NET-VM Improvements}

The primary focus of enforcement provided by our NET-VM is external to the VM. For example, we allow specific flows that are specified in the contracts of virtual appliances. However, we do not yet have enforcement mechanisms within the VM. Although we do have enough visibility into the network-based actions of the virtual appliances, we have not put triggers and enforcement in place to respond to and recovery from certain situations. As part of future implementation work for our NET-VM we plan to include mechanisms that will, for example, limit the number of invalid port request a virtual appliance can make before a security response is taken. Security responses could include restoring the virtual appliance to a known-good state, alerting an administrator, or logging the request for security research purposes. Other policies and responses will also be considered. For example, by using introspection techniques we could detect that a virtual appliance is trying to listen on ports that it is not supposed to. One such technique could us a trusted and memory-protected version of netstat to get an accurate view of open ports. Another technique could be to allow, at the virtual switch level, special access to a network monitoring service (perhaps running on the NET-VM) to scan with a network port scanner (such as Nmap) for ports that are not supposed to be open on a virtual appliance.

Another implementation related improvement of our NET-VM that we would like to make is the architectural placement of it. In our current implementation, our NET-VM component does not reside in its own VM, since it needs access to the virtual switches in the management domain. However, our virtual switches are implemented with the Open vSwitch technology\cite{ovs_hotnets_2009} and therefore can be extended to be controlled by a OpenFlow\cite{mckeown_2008} controller, such as NOX\cite{gude_2008}. This means that we could use an OpenFlow controller (like NOX) in our NET-VM component in its own VM and have programmatic control of the virtual switches. Moving the NET-VM component into its own VM separates it logically and opens up the possibility to move it to an external system, if desired.

Lastly, future exploration should be done to determine if the enforcement mechanisms provided by our NET-VM could be applied more generally to physical hardware switches that support the OpenFlow protocol. This could allow a system such as ours to be used to protect non-virtualized devices (for example, desktop computers) at the network switch level. Further investigation should be done to determine if OpenFlow switches that are controlled externally by a controller can provide better central management and easier migration of virtual machines. It should also be possible to replace the ARP protocol with an controller-implemented equivalent or remove the need for the ARP protocol altogether\cite{casado_2007}. Some of our NET-VM research and deployment was inspired by the research and deployment work done at Stanford University on a project called Ethane\cite{casado_2007}.

\subsubsection{OSCKAR Improvements}

The OSCKAR virtualization security framework is intentionally designed to be simple and modular. Possible implementation-related improvements could consider ways in which other RPC mechanisms could be interchanged. Also, providing RESTful APIs and APIs for other programming languages could help adoption of our framework. As OSCKAR is still in alpha stage of development, it still needs to be tested more and better error handling should be integrated.

As mentioned in the Chapter 4, future implementation work could enhance our builder component by integrating Stacklet (a virtual appliance building tool), adding support for installation via CD or DVD, and automating Windows installs. In Chapter 4, we also suggested that we could automate the process of adding the mount points needed by the FS-VM as well as any other meta guest changes needed by other enforcement elements.

We would also like to continue to support the development and combination of products built on top of OSCKAR. For example, our Rapid Recovery Desktop system includes support for NET-VM and FS-VM enforcement elements, but other products, such as KIOSCKAR (the VM kiosk that we implemented and describe in Chapter 4), would also benefit from such integration. Also, work is underway to improve KIOSCKAR so that it supports the SPICE\cite{spice_website} VDI protocol, which will provide a smoother mouse and graphics user experience for VMs running on the kiosk.

Other virtualization security use cases that could be explored as possible products built on top of OSCKAR include one application per VM scenarios (examples include~\cite{apiary_usenix_2010,virtics_2010,qubes-os_2010}), virtualization-supported thin client solutions, web management of virtual machines or virtual appliances for infrastructure as a service (IaaS) support, and desktop as a service (DaaS) deployments. We will also discuss applying our system to other environments in section \ref{sec:fw-other-environments}. 

\subsubsection{Enforcement Element Additions}

Throughout the dissertation we have described various enforcement elements that could be useful to integrate with our system. In this section we describe those and other enforcement elements that could be considered in future work. We consider new enforcement elements for mandatory access control (MAC), introspection, host-based intrusion detection (HIDS), network-based intrusion detection (NIDS), anti-virus, and system-data-specific file handling.

The MAC enforcement element could provide central management of MAC policies, such as the VMAC research project presented by Quynh et. al.\cite{Quynh_2006}. Other approaches could use MAC implemented at the hypervisor level, such as sVirt\cite{sVirt_website} or XSM\cite{xsm_xen_summit_3rd,xsm_xen_summit_4th}. A MAC enforcement element that took advantage of a hypervisor-level MAC system could either be built into the hypervisor or be a privileged VM that had access to manage MAC policy.

Another type of enforcement element that could be added is one that does introspection. Virtual Machine Introspection (VMI) is the approach of inspecting a virtual machine from the outside for the purpose of analyzing the software running inside of it\cite{VMI_IDS_2003}. One VMI technique that we could consider integrating is XenAccess\cite{xenaccess_07}, which is a monitoring library for VMs running on Xen. Another is Lares\cite{payne_lares_2008}, which is an architecture for secure active monitoring that makes use of a security VM to handle enforcement. Two other systems that were prototyped on KVM, include KvmSec\cite{lombardi_2009}, which is a security extension for Linux/KVM, and SIM\cite{sharif_2009}, which is a secure in-VM monitoring framework.
 
Other enforcement elements we should consider integrating in future work include ones that do intrusion detection and provide anti-virus protection. These types of protections generally rely on introspection techniques. Research systems include Livewire\cite{VMI_IDS_2003} and Hyperspector\cite{HyperSpector05}, both of which use introspection for intrusion detection. Introspection techniques for anti-virus are also showing up in practice with virtualization vendors and anti-virus companies partnering up to provide a single anti-virus agent running outside of the VMs. Two specific partnerships include Citrix with McAfee\cite{citrix_mcafee_2010} and VMware and TrendMicro\cite{vmware_trendmicro_2010}. As part of future work, we could integrate introspection techniques combined with open source intrusion detection systems (such as Snort\cite{roesch_1999}, Bro\cite{paxson_1999}, or Suricata\cite{suricata_website}) and anti-virus systems (such as ClamAV\cite{clamav_website} or AVFS\cite{miretskiy_2004}) with our system.

Finally, an enforcement element that we could consider implementing would be a variation of our FS-VM. Our FS-VM stores user data, but other file system VMs, such as SVFS\cite{zhao_2005} protect system data instead of user data. Qubes OS\cite{qubes-os_2010} also uses a file system-based VM to protect system data. This approach to protecting system data is not a simple extension of the FS-VM, but should instead be considered a new enforcement element and future work should consider the existing approaches in order to integrate the best system data-based file server or file system VM. Many of the FS-VM design and implementation details could still apply to this type of enforcement element.

\subsubsection{Overall System Improvements}

At the overall system level, there are several directions for future exploration. For example, a careful study of the Qubes OS architecture, could reveal possible techniques or implementation details that could improve the overall system. We suspect that in particular the approach that Qubes OS takes for securing graphics display, send-to, and copy-and-paste operation may be useful to re-use in our system. It is worth re-emphasizing however that Qubes OS has a very different threat model than our system (this was described in detail in Chapter 2), so careful integration of the Qubes OS components would need to be considered carefully.

Another potential area for increased performance and security would be to make use of IOMMU and secure boot (for example Intel TXT) support built into modern commodity hardware designed for virtualization. Our current architecture does not restrict us from using such hardware, so making use of this hardware when available should be straightforward. Examples of making use of IOMMU and secure boot support is found in the Qubes OS design. 

Finally, user interface improvements could include a more transparent integration of virtual appliances. For example, supporting drag-and-drop of files, send-to of files, and copy-and-paste between VMs in a secure way could be important. For example, the user interface interactions such as those employed by Polaris\cite{stiegler_2006} or Qubes OS might be helpful. Other techniques for more user friendly integration of VMs include Windows 7's XP mode, VirtualBox's seamless mode, and VMware Fusion's Unity mode.

\subsection{Application to Other Environments}
\label{sec:fw-other-environments}

This dissertation presented an attack resistant and rapid recovery desktop system, but application to over environments is possible. For example, the most obvious extension of our architecture is in server or data center environment. Virtual machine contracts for data center environments was discussed by Matthews et. al.\cite{virtual_machine_contract_ICAC09}. The approach taken by our system could also be helpful for public and hybrid cloud environments as well, since well defined contracts for virtual appliance as well as protection and recovery would be useful when moving to and from private data centers to public cloud environments. The use of virtualization is an important part of many private, hybrid, and public cloud setups.

Applying our system to more specialized environments, such as web applications or mobile devices would also likely be quite useful. Placing protections on web or mobile applications is of great concern to security researchers and many similar access control, isolation, and privilege problems exist on those platforms. Some good examples of technologies that use similar techniques that our system does include process and browser-based sandboxes such as Gazelle\cite{grier_gazelle_2009}, Native Client\cite{yee_nacl_2009}, Xax\cite{douceur_xax_2008}, Google Chrome\cite{reis_2009}, and Chromium OS\cite{chromium_os_security_overview_website}. Mobile platforms, especially smart phones, could also benefit from application protection, similar to some of the techniques that the Android~\cite{canning_android_keynote_2009,android_security_dev} platform has designed and implemented. These other systems attempt to provide isolation, access control, and least privilege, and as part of future work we could try to extend our system to support these types of platforms explicitly. Finally, as we have already mentioned, VDI-based situations are already well-suited to work with our system and we hope to do future work to explore this more.

